{"componentChunkName":"component---src-templates-chapter-js","path":"/chapter7","result":{"data":{"site":{"siteMetadata":{"courseId":"monash-intro-r"}},"markdownRemark":{"htmlAst":{"type":"root","children":[{"type":"element","tagName":"exercise","properties":{"id":"1","title":"Simple linear regression","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"slides","properties":{"source":"chapter7_01_simple-linear-regression"},"children":[{"type":"text","value":" "}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"2","title":"Practice extracting model estimates"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"library(Ecdat)\nstr(Cigarette)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"## 'data.frame':    528 obs. of  9 variables:\n##  $ state : Factor w/ 48 levels \"AL\",\"AR\",\"AZ\",..: 1 2 3 4 5 6 7 8 9 10 ...\n##  $ year  : int  1985 1985 1985 1985 1985 1985 1985 1985 1985 1985 ...\n##  $ cpi   : num  1.08 1.08 1.08 1.08 1.08 ...\n##  $ pop   : int  3973000 2327000 3184000 26444000 3209000 3201000 618000 11352000 5963000 2830000 ...\n##  $ packpc: num  116 129 105 100 113 ...\n##  $ income: int  46014968 26210736 43956936 447102816 49466672 60063368 9927301 166919248 78364336 37902896 ...\n##  $ tax   : num  32.5 37 31 26 31 ...\n##  $ avgprs: num  102.2 101.5 108.6 107.8 94.3 ...\n##  $ taxs  : num  33.3 37 36.2 32.1 31 ..."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This data was collected for each state from 1985 to 1995 in USA. The\nvariables are described further below:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"state"}]},{"type":"text","value":": state"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"year"}]},{"type":"text","value":": year"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"cpi"}]},{"type":"text","value":": consumer price index"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pop"}]},{"type":"text","value":": state population"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"packpc"}]},{"type":"text","value":": number of cigarette packs per capita"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"income"}]},{"type":"text","value":": state personal income (total, nominal)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"tax"}]},{"type":"text","value":": average state, federal, and average local excise taxes for\nfiscal year"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"avgprs"}]},{"type":"text","value":": average cigarette price during fiscal year, including\nsales taxes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"taxs"}]},{"type":"text","value":": average excise taxes for fiscal year, including sales taxes"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A simple linear model for the average cigarette price on average excise\ntaxes was proposed."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Fit the model using least squares approach and calculate:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"(a) residual sum of squares and assign it to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"RSS"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n(b) least squares estimate of the intercept to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"beta0"}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n(c) least squares estimate of the slope to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"beta1"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"07_02A"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Hint: What did functions "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"coef()"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"residuals()"}]},{"type":"text","value":" do?"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"3","title":"Multiple linear regression","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"slides","properties":{"source":"chapter7_02_multiple-linear-regression"},"children":[{"type":"text","value":" "}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"4","title":"Test your knowledge"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We extend the previous model for the average cigarette price by\nregressing it on the covariates:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"average excise taxes for fiscal year and"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"consumer price index."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"library(tidyverse)\nlibrary(broom)\ndata(Cigarette, package = \"Ecdat\")\n\nfit <- lm(avgprs ~ taxs + cpi, data = Cigarette)\nggplot(augment(fit), aes(.fitted, .resid)) +\n  geom_hline(yintercept = 0) +\n  geom_point() "}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 790px; "},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/57f99d8053e46ec4468d8aad641bcc3f/abddd/unnamed-chunk-2-1.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB3klEQVQoz22SSY9pURSF/Unj9ytEjMRIYmxoQIgBiUSCASIkhIjo+755KC5XW4Xo3nfveeW9StUa3Jxz7t5rrd1oHo/H4XDYbre73W77ifV6zXe/3282m+VyOZvNOG+/gizN8/k8n8+SJK1WK0kF0b9VtNvt+XzeaDQmk4n0DfBqUIaVTNRWKkjo9XrlcjkYDNbr9cFgUKvVhsOhLMur/6Akv5SFJpmj0ahSqYRCIb/fH41Gi8ViPp+fTqew/6CMe8FEMiI+n89sNtvt9lgslkwm2yr6/f5isSBAsBBP2Rr0TufzRpY7nQ4+rVarwWDQ6XQ2m83pdEYikW63ix2Sx+MxzkmGhXxFWenxbkeEw+H4pUKv11ssFpfLhQXocrlcPB5PpVKlUqnZbMIyVMEIlJqv1yst9Xq9Wq3WaDSihghBlEDbqDmbzeILzXQ6/eqcony/34/HI6Eej8dkMpGJK+qBOJPJJBKJcDjcarUKhQJcvH+xjfLlcuECZbVa5Un0gwgEA4GA2+3OqOAq1oEAqDkryvAJG/gRAxMLg3kGzpwpCtui4eLXvzlTsyjjtXpCnxGyP4RilYbLKthi/hL8dz1FPqvy/MTtdjudThwWb2+Hw/H5eIirAKvx8f7B4Q8y56jHRcAECgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n          "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/57f99d8053e46ec4468d8aad641bcc3f/d8b2f/unnamed-chunk-2-1.webp 198w","/static/57f99d8053e46ec4468d8aad641bcc3f/8d48d/unnamed-chunk-2-1.webp 395w","/static/57f99d8053e46ec4468d8aad641bcc3f/199e2/unnamed-chunk-2-1.webp 790w","/static/57f99d8053e46ec4468d8aad641bcc3f/c0ed6/unnamed-chunk-2-1.webp 864w"],"sizes":["(max-width:","790px)","100vw,","790px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n          "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/57f99d8053e46ec4468d8aad641bcc3f/920f7/unnamed-chunk-2-1.png 198w","/static/57f99d8053e46ec4468d8aad641bcc3f/ddeb6/unnamed-chunk-2-1.png 395w","/static/57f99d8053e46ec4468d8aad641bcc3f/75051/unnamed-chunk-2-1.png 790w","/static/57f99d8053e46ec4468d8aad641bcc3f/abddd/unnamed-chunk-2-1.png 864w"],"sizes":["(max-width:","790px)","100vw,","790px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n          "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/57f99d8053e46ec4468d8aad641bcc3f/75051/unnamed-chunk-2-1.png","alt":"unnamed chunk 2 1","title":"unnamed chunk 2 1","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n        "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Based on the above plot, do you think the fitted model is reasonable?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"choice","properties":{"id":"0.350873241433874"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"Yes","correct":"true"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nope. Try again."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"opt","properties":{"text":"No"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"That’s right! There’s a clear curve in the residual vs fitted plot."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"5","title":"Regression with categorical variables","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"slides","properties":{"source":"chapter7_03_regression-with-categorical-var"},"children":[{"type":"text","value":" "}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"6","title":"Practice modelling with categorical variables"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Below we calculate the mean of the average cigarette prices across the\nyears by state."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"Cigarette %>% \n  group_by(state) %>% \n  summarise(avg = mean(avgprs)) %>% \n  deframe()"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"##       AL       AR       AZ       CA       CO       CT       DE       FL \n## 139.7866 148.9497 150.2908 169.2056 138.4311 176.9969 141.2955 162.9414 \n##       GA       IA       ID       IL       IN       KS       KY       LA \n## 134.1717 156.8082 146.3151 158.2791 134.7945 149.1001 122.1246 148.8910 \n##       MA       MD       ME       MI       MN       MO       MS       MT \n## 164.5658 142.2264 163.6511 153.6489 176.6886 132.2249 148.1670 137.1841 \n##       NC       ND       NE       NH       NJ       NM       NV       NY \n## 123.6782 155.1322 151.7466 139.1136 163.4517 145.4603 171.6562 169.5765 \n##       OH       OK       OR       PA       RI       SC       SD       TN \n## 139.4949 149.3375 153.6705 148.2836 159.7435 130.4506 145.7649 144.4112 \n##       TX       UT       VA       VT       WA       WI       WV       WY \n## 162.7255 153.6170 135.9938 148.2788 185.1092 161.5576 146.3152 130.8280"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Model the average cigarette price on the categorical variable "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"state"}]},{"type":"text","value":"\nwith the intercept removed from the model. Assign the coefficients from\nyour model to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"betas"}]},{"type":"text","value":". Do you notice anything about the values printed?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"codeblock","properties":{"id":"07_06A"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Hint: Add "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"-1"}]},{"type":"text","value":" or "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"0"}]},{"type":"text","value":" to the right hand side of the model formula to\nremove the intercept."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"7","title":"Regression models with interaction effects","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter7_04_interaction"},"children":[{"type":"text","value":" "}]},{"type":"text","value":" "}]},{"type":"text","value":"\n"},{"type":"element","tagName":"exercise","properties":{"id":"8","title":"Visualising regression models","type":"slides"},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"slides","properties":{"source":"chapter7_05_visualisation"},"children":[{"type":"text","value":" "}]},{"type":"text","value":" "}]}],"data":{"quirksMode":false}},"frontmatter":{"id":7,"title":"Chapter 7: Linear regression with R","description":"This chapter demonstrates how to fit linear models in R. You'll learn about how to fitting simple linear regression, models with categorical variables and interaction effects, and visualising models with ggplot2.\n","next":"/chapter7","prev":"/chapter6"}}},"pageContext":{"slug":"/chapter7"}},"staticQueryHashes":["1029480139","1771538597","3063084251","4240431937"]}